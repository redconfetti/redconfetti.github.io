---
layout: post
published: true
title: Developing and Deploying in the Cloud
description: A Guide to using Amazon Cloud9 and Ansible with Amazon Web Services
image_url: /images/posts/2019-03-23-ansible-logo.png
date: 2019-03-23 12:56:00 -0800
categories:
  - infrastructure
tags:
  - ansible
  - cloud9
  - aws
  - software provisioning
  - configuration management
  - application deployment
---

This guide assumes that you already have an Amazon Cloud9 environment setup
and connected to an EC2 instance running Amazon Linux (a Red-Hat related
distribution), and that you have pre-existing experience with [Git].

We will use a tool known as Ansible to maintain the state of our Cloud9
development environment, as well as maintaining and deploying a static website
to a production environment.

After you are finished with this guide, you should be able to use the
configuration you have established to maintain your existing environments,
or re-establish them again in new environments. Should your Cloud9 EC2 instance
become terminated/destroye, you'll be able to checkout your Ansible
configuration from Git and re-provision your environments quickly and easily.

You should also be able to continue beyond this guide configuring and managing
whatever infrastructure is needed.

[Git]: https://en.wikipedia.org/wiki/Git

# Introduction

[Ansible] is a an open-source tool you can use to install and configure
software on your Linux systems, as well as deploy new software updates.

Ansible is programmed in Python, however you do not need to know Python to use it.

All you need to do is learn to understand [YAML], [Jinja templates], and read
the [Ansible Project Documentation].

This guide uss Ansible not as an Ad-Hoc (command line) tool, but instead as a
repository of files used to manage a local or remote infrastructure.

To serve as an example, this guide will configure Ansible to run locally on the
Amazon Linux EC2 instance that is setup by default with the
[Amazon Cloud9 Web-based IDE], and then expand that configuration to provision
another EC2 instance that will host a static website.

[Amazon Cloud9 Web-based IDE]: https://aws.amazon.com/cloud9/
[Ansible]: https://en.wikipedia.org/wiki/Ansible_(software)
[Ansible Project Documentation]: https://docs.ansible.com/
[YAML]: https://en.wikipedia.org/wiki/YAML
[Jinja templates]: https://en.wikipedia.org/wiki/Jinja_(template_engine)

# A Note About Idempotency

After provisioning the software and configurations for the first time, Ansible
can be used to maintain the state of your infrastructure in an idempotent
manner.

This means that you can run a command for Ansible to connect to your servers
and perform checks on each server to ensure that they're running the software
you expect, with the configuration you expect. If the state of the machine
isn't as expected, Ansible will then perform the right steps to re-apply the
expected state to the machine. This means that you can run an Ansible command
or playbook over and over again, and the outcome should be the same everytime.

This however depends on the Ansible modules you use, and how they are configured
to maintain the state of your infrastructure.

It is possible that with certain practices you can run into an issue known as
"configuration drift".

Refer to [Ansible Idempotency and Configuration Drift] later for information
on avoiding this issue.

[Ansible Idempotency and Configuration Drift]: https://shadow-soft.com/ansible-idempotency-configuration-drift/

# Establishing a Git repository



# Installing the Ansible Engine

Here are some of the commands to install Ansible on common Linux distributions.
I'm including the Amazon Linux compatible command first, but including others.

```bash
# Install for RHEL, CentOS, or Amazon Linux
sudo yum install ansible

# Install for Fedora
sudo dnf install ansible

# Configure PPA and Install for Ubuntu
sudo apt-get update
sudo apt-get install software-properties-common
sudo apt-add-repository --yes --update ppa:ansible/ansible
sudo apt-get install ansible
```

See [Ansible Installation Guide] for other system installation instructions.

The machine that you install and run Ansible from is usually referred to as
the 'management node'.

[Ansible Installation Guide]: https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html

# Configuration

After completing the install, the default Ansible configuration files is located
under `/etc/ansible/ansible.cfg`.

# Inventory

Ansible is able to manage the state of multiple machines. By default, the
inventory is defined in `/etc/ansible/hosts` using a format similar to an
[INI file].

```

```

For more information, see [Ansible - Working with Inventory]

[Ansible - Working with Inventory]: https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html
[INI file]: https://en.wikipedia.org/wiki/INI_file

# Modules

Ansible supports many modules. You can view a list of all available modules
by running:

```bash
ansible-doc -l
```

You can read the documentation for a specific module by using the command:

```bash
ansible-doc <module-name>

# View 'hostname' module documentation
ansible-doc hostname
```
